@model StatisticsGetViewModel
@{
    ViewData["Title"] = "Statistics";
    Layout = "~/Views/MainLayout/Index.cshtml";
}
<!--begin::Content-->
<div class="card card-custom mt-10">
   <!--begin::Header-->
   <div class="card-body pb-0">
       <h1 class="page-title">Türkiye Kelebek Gözlem Veritabanı</h1>
       <p class="page-description">
           Türkiye'nin en kapsamlı kelebek gözlem platformuna hoş geldiniz. Bu platform, ülkemizdeki kelebek türlerinin dağılımını, yaşam döngülerini ve habitatlarını takip etmemizi sağlayan bir veri tabanıdır.
       </p>

       <!--begin::Stats-->
       <div class="row g-5 g-xl-8 mb-8">
           <div class="col-xl-3">
               <div class="bg-dark stat-card">
                   <span class="text-white stat-number">@Model.TotalObservationCount</span>
                   <div class="text-white stat-label">Toplam Gözlem</div>
               </div>
           </div>
           <div class="col-xl-3">
                <div class="bg-dark stat-card">
                   <span class="text-white stat-number">@Model.TotalSpeciesCount</span>
                   <div class="text-white stat-label">Toplam Tür</div>
               </div>
           </div>
           <div class="col-xl-3">
                <div class="bg-dark stat-card">
                   <span class="text-white stat-number">@Model.TotalFamilyCount</span>
                   <div class="text-white stat-label">Toplam Familya</div>
               </div>
           </div>
           <div class="col-xl-3">
                <div class="bg-dark stat-card">
                   <span class="text-white stat-number">@Model.TotalObserverCount</span>
                   <div class="text-white stat-label">Toplam Gözlemci</div>
               </div>
           </div>
       </div>
   </div>

   <!--begin::Carousel-->
   <div class="card-body pt-0">
       <div class="carousel-wrapper">
           <div id="kt_carousel" class="carousel slide" data-bs-ride="carousel" data-bs-interval="3000">
               <div class="carousel-inner">
                   <div class="carousel-item active">
                       <div class="position-relative">
                           <img src="/images/butterfly1.jpg" class="carousel-image" alt="Common Blue"/>
                           <div class="carousel-caption-overlay">
                               <div class="container">
                                   <div class="text-center">
                                       <h2 class="carousel-title">Common Blue</h2>
                                       <p class="carousel-subtitle">Polyommatus icarus</p>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
                   <div class="carousel-item">
                       <div class="position-relative">
                           <img src="/images/butterfly2.jpg" class="carousel-image" alt="Swallowtail"/>
                           <div class="carousel-caption-overlay">
                               <div class="container">
                                   <div class="text-center">
                                       <h2 class="carousel-title">Swallowtail</h2>
                                       <p class="carousel-subtitle">Papilio machaon</p>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
                   <div class="carousel-item">
                       <div class="position-relative">
                           <img src="/images/butterfly3.jpg" class="carousel-image" alt="Painted Lady"/>
                           <div class="carousel-caption-overlay">
                               <div class="container">
                                   <div class="text-center">
                                       <h2 class="carousel-title">Painted Lady</h2>
                                       <p class="carousel-subtitle">Vanessa cardui</p>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
                    <div class="carousel-item">
                        <div class="position-relative">
                            <img src="/images/butterfly5.jpg" class="carousel-image" alt="Painted Lady" />
                            <div class="carousel-caption-overlay">
                                <div class="container">
                                    <div class="text-center">
                                        <h2 class="carousel-title">Painted Lady</h2>
                                        <p class="carousel-subtitle">Vanessa cardui</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
               </div>
               <button class="carousel-control-prev" type="button" data-bs-target="#kt_carousel" data-bs-slide="prev">
                   <span class="carousel-control-prev-icon"></span>
               </button>
               <button class="carousel-control-next" type="button" data-bs-target="#kt_carousel" data-bs-slide="next">
                   <span class="carousel-control-next-icon"></span>
               </button>
           </div>
       </div>
   </div>

   <!--begin::Charts-->
   <div class="card-body pt-0">
       <div class="row g-5 g-xl-8">
           <div class="col-xl-6">
               <div class="card chart-card">
                   <h3 class="chart-title">İllere Göre Dağılım</h3>
                   <div class="card-body">
                       <div id="province_chart" style="height: 350px"></div>
                   </div>
               </div>
           </div>
           <div class="col-xl-6">
               <div class="card chart-card">
                   <h3 class="chart-title">Familyalara Göre Dağılım</h3>
                   <div class="card-body">
                       <div id="family_chart" style="height: 350px"></div>
                   </div>
               </div>
           </div>
       </div>
   </div>

   <div class="card-body pt-0">
       <div class="row g-5 g-xl-8">
           <div class="col-xl-12">
               <div class="card chart-card">
                   <h3 class="chart-title">En Çok Gözlemlenen Türler ve Ortalama Yükseklikleri</h3>
                   <div class="card-body">
                       <div id="species_chart" style="height: 350px"></div>
                   </div>
               </div>
           </div>
       </div>
   </div>
</div>
@section Styles {
    <style>
        /* Ana başlık ve açıklama stilleri */
        .page-title {
            font-size: 2.5rem !important;
            font-weight: 600 !important;
            color: #181C32 !important;
            margin-bottom: 1rem !important;
        }

        .page-description {
            font-size: 1.1rem !important;
            color: #7E8299 !important;
            margin-bottom: 2rem !important;
        }

        /* İstatistik kartları */
        .stat-card {
            padding: 1.5rem;
            border-radius: 0.625rem !important;
            min-height: 140px;
        }

        .stat-number {
            font-size: 2.5rem !important;
            font-weight: 600 !important;
            line-height: 1.2;
            margin-bottom: 0.5rem;
        }

        .stat-label {
            font-size: 1rem !important;
            font-weight: 500 !important;
        }

        .carousel-wrapper {
            margin: 2rem 0;
            border-radius: 0.625rem;
            overflow: hidden;
            position: relative;
        }

        .carousel-image {
            height: 280px !important; /* Yüksekliği azalttım */
            width: 100% !important;
            object-fit: contain !important; /* cover yerine contain kullandım */
            background-color: #f5f8fa; /* Arka plan rengi ekledim */
        }

        .carousel-caption-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            background: rgba(0, 0, 0, 0.5) !important; /* Gradient yerine düz overlay */
            padding: 1rem 0 !important;
        }

        .carousel-title {
            font-size: 2rem !important;
            font-weight: 600 !important;
            margin-bottom: 0.5rem !important;
        }

        .carousel-subtitle {
            font-size: 1.2rem !important;
            font-weight: 500 !important;
        }

        .carousel-control-prev,
        .carousel-control-next {
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
            margin: 0 1rem;
        }

        .carousel-control-prev-icon,
        .carousel-control-next-icon {
            width: 20px;
            height: 20px;
        }

        /* Grafik kartları */
        .chart-card {
            border-radius: 0.625rem !important;
            box-shadow: 0px 0px 20px 0px rgba(76, 87, 125, 0.02) !important;
        }

        .chart-title {
            font-size: 1.25rem !important;
            font-weight: 600 !important;
            color: #181C32 !important;
            padding: 1.5rem !important;
        }
    </style>
}
@section Scripts {
    <script>
        // Province Chart
        var provinceData = @Json.Serialize(Model.TopProvinces);
        var provinceChart = new ApexCharts(document.querySelector("#province_chart"), {
            series: [{
                data: provinceData.map(x => x.observationCount)
            }],
            chart: { type: 'bar', height: 350 },
            xaxis: { categories: provinceData.map(x => x.provinceName) },
            colors: ['#009ef7']
        });
        provinceChart.render();

        // Family Chart
        var familyData = @Json.Serialize(Model.TopFamilies);
        var familyChart = new ApexCharts(document.querySelector("#family_chart"), {
            series: familyData.map(x => x.observationCount),
            labels: familyData.map(x => x.familyName),
            chart: { type: 'pie', height: 350 },
            colors: ['#009ef7', '#50cd89', '#f1416c', '#ffc700', '#7239ea']
        });
        familyChart.render();

            var speciesData = @Json.Serialize(Model.TopSpecies);
        var speciesChart = new ApexCharts(document.querySelector("#species_chart"), {
            series: [{
                name: 'Gözlem Sayısı',
                data: speciesData.map(x => x.observationCount)
            }, {
                name: 'Ortalama Yükseklik (m)',
                data: speciesData.map(x => x.averageAltitude)
            }],
            chart: {
                type: 'bar',
                height: 350
            },
            xaxis: {
                categories: speciesData.map(x => x.speciesName),
                labels: { rotate: -45 }
            },
            yaxis: [
                {
                    title: { text: 'Gözlem Sayısı' }
                },
                {
                    opposite: true,
                    title: { text: 'Yükseklik (m)' }
                }
            ],
            colors: ['#009ef7', '#50cd89']
        });
        speciesChart.render();
    </script>
}